##VARIABLE CREATION AND RECODING## /  / ##label variables as factors## / soc$refCountry<-factor(soc$refCountry) / soc$refNum<-factor(soc$refNum) /  / ##aggregate and standardize IVS and DVS## / soc$meanrate<-rowMeans(cbind(soc$rater1, soc$rater2)) / soc$ztone<-scale(soc$meanrate) / soc$zrcard<-scale(soc$redCards) / soc$zycard<-scale(soc$yellowCards) / soc$zyrcard<-scale(soc$yellowReds) / soc$zgames<-scale(soc$games) / soc$zIAT<-scale(soc$meanIAT) / soc$zExp<-scale(soc$meanExp) /  / ##Body-Mass Index## / soc$bmi<-(soc$weight/soc$height^2)*10000 /  / ##total carded fouls (bookings)## / soc$totbook<-soc$redCards+soc$yellowCards+2*soc$yellowReds / soc$zbook<-scale(soc$totbook) /  / ##player losing percentage within each referee dyad## / soc$losep<-soc$defeats/soc$games /  / ##player scoring rate within each referee dyad## / soc$gpgame<-soc$goals/soc$games /  / ##recoding skin tone into African-appearing vs. Non-African-appearing categories(based on visual inspection of coder rating categories, NB - drops all players from "neither light nor dark" category## / soc$tonecode<-ifelse(soc$meanrate<3, "white", ifelse(soc$meanrate>3, "black", NA)) / soc$tonecode<-factor(soc$tonecode) /  /  /  / ##EVALUATING RANDOM COMPONENTS OF VARIANCE## /  /  /  / ##fixed intercept model## / intercept.model.gls<-gls(redCards~games, data=soc, na.action=na.exclude) /  / ##random intercept by referee## / intercept.model<-lme(redCards~games, random=~1|refNum, data=soc, na.action=na.exclude) /  / ##random intercept model with referee country## / intercept.country<-update(intercept.model, random=~1|refCountry) /  / ##model comparison## / anova(intercept.model, intercept.model.gls) / anova(intercept.country, intercept.model.gls) /  / ##random skintone slope models## / slope.model<-lme(redCards~games+meanrate, random=~meanrate|refNum, data=soc, na.action=na.exclude) / slope.country<-lme(redCards~games+meanrate, random=~meanrate|refCountry, data=soc, na.action=na.exclude) /  / ##model comparisons## / noslope.model<-update(slope.model, random=~1|refNum) / anova(slope.model, noslope.model) / noslope.country<-update(slope.country, random=~1|refCountry) / anova(slope.country, noslope.country) /  / ##random three-level intercept with referee nested within referee country## / three.level.intercept<-lme(redCards~games, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) /  / ##model comparisons## / anova(three.level.intercept, intercept.model) / anova(three.level.intercept, intercept.country) /  / ##random three-level intercept model with random skintone slope## / three.level.slope<-lme(redCards~games+meanrate, random=~meanrate|refCountry/refNum, data=soc, na.action=na.exclude) /  / ##model comparison## / noslope.threelevel<-update(three.level.slope, random=~1|refCountry/refNum) / anova(three.level.slope, noslope.threelevel) /  /  /  / ##EXAMINING POSSIBLE CONFOUNDS WITH SKIN TONE## /  /  /  / ##to retain all cases for player-level matrix a revised dataset--poscode--was manually created in which NAs for position were recoded to "unknown"## /  / ##create a player-level matrix## / plevel<-aggregate(cbind(goals, games)~playerShort+club+position, poscode,sum, na.action=na.pass) /  / ##multipe steps required to retain all players despite missing data## / plevel1<-aggregate(bmi~playerShort+club+position, poscode,mean, na.action=na.pass) / plevel2<-aggregate(meanrate~playerShort+club+position, poscode,mean, na.action=na.pass) / plevel3<-aggregate(defeats~playerShort+club+position, poscode,sum, na.action=na.pass) / plevel4<-aggregate(daysold~playerShort, playerage, mean, na.action=na.pass)##age converted in separate file## /  / ##retaining only nonredundant variables## / plevel1<-plevel1[,c(1,4)] / plevel2<-plevel2[,c(1,4)] / plevel3<-plevel3[,c(1,4)] /  / ##merging into a single matrix## / plevel<-merge(plevel, plevel1, by="playerShort") / plevel<-merge(plevel, plevel2, by="playerShort") / plevel<-merge(plevel, plevel3, by="playerShort") / plevel<-merge(plevel, plevel4, by="playerShort") /  / ##calculating player-level indices (aggregate goals per game and losing percentage)## / plevel$plevgpgame<-plevel$goals/plevel$games / plevel$plevlosep<-plevel$defeats/plevel$games /  / ##correlating player factors with skin tone (requires psych package)## / with(plevel, corr.test(cbind(meanrate, plevgpgame, plevlosep, bmi, daysold))) /  / ##evaluating associations of position and club with skin tone## / anova(lm(meanrate~position, data=plevel, subset=position!="unknown"))##removing players with missing position data## / summary(lm(meanrate~position, data=plevel, subset=position!="unknown")) / tapply(plevel$meanrate, plevel$position, mean, na.rm=T) / tapply(plevel$meanrate, plevel$position, sd, na.rm=T) / anova(lm(meanrate~club, data=plevel)) / summary(lm(meanrate~club, data=plevel)) /  / ##do club and position predict Red Cards?## /  / club.effect.rcard<-lme(zrcard~zgames+club, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(club.effect.rcard) / round(summary(club.effect.rcard)$tTable,dig=3) /  / position.effect.rcard<-lme(zrcard~zgames+position, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(position.effect.rcard) / round(summary(position.effect.rcard)$tTable,dig=3) /  / ##PRIMARY ANALYSES OF RED CARDS## /  / ##zero order skin tone effect## / tone.rcard<-lme(zrcard~zgames+ztone, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(tone.rcard) / round(summary(tone.rcard)$tTable,dig=3) /  / ##skin tone with confounds## / clubpos.tone.rcard<-lme(zrcard~zgames+position+club+ztone, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(clubpos.tone.rcard) / round(summary(clubpos.tone.rcard)$tTable,dig=3) / confint(clubpos.tone.rcard, "ztone") /  / ##moderated by IAT?## / clubposiat.tone.rcard<-lme(zrcard~zgames+position+club+ztone*scale(meanIAT), random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(clubposiat.tone.rcard) / round(summary(clubposiat.tone.rcard)$tTable,dig=3) / confint(clubposiat.tone.rcard,"ztone:zIAT") /  / ##moderated by Explicit Prejudice?## / clubposexp.tone.rcard<-lme(zrcard~zgames+position+club+ztone*scale(meanExp), random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(clubposexp.tone.rcard) / round(summary(clubposexp.tone.rcard)$tTable,dig=3) / confint(clubposexp.tone.rcard,"ztone:zExp") /  / ##are club effects partially explained by aggregate skin tone? - create club-level variables## / temp<-aggregate(soc$meanrate, list(soc$club), mean, na.rm=T) / temp1<-aggregate(soc$plevgpgame, list(soc$club), mean, na.rm=T) / temp2<-aggregate(soc$bmi, list(soc$club), mean, na.rm=T) / soc$black<-ifelse(soc$meanrate>3, 1, 0) / temp3<-aggregate(soc$black, list(soc$club), sum, na.rm=T) / soc<-merge(soc, temp, by="club")##aggregate variables need to be renamed - clubtone## / soc<-merge(soc, temp1, by="club")##aggregate variables need to be renamed - clubgpg## / soc<-merge(soc, temp2, by="club")##aggregate variables need to be renamed - clubbmi## / soc<-merge(soc, temp3, by="club")##aggregate variables need to be renamed - clubblack## / soc$zclubtone<-scale(soc$clubtone) / soc$zclubgpg<-scale(soc$clubgpg) / soc$zclubbmi<-scale(soc$clubbmi) / soc$zclubblack<-scale(soc$clubblack) /  / ##zero order club level skin tone effect## / clubtone.rcard<-lme(zrcard~zgames+ztone+scale(clubtone), random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(clubtone.rcard) / round(summary(clubtone.rcard)$tTable,dig=3) /  /  / ##mean club skin tone analysis with confounds## / clubtonepos.rcard<-lme(zrcard~zgames+position+ztone+zclubtone, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(clubtonepos.rcard) / round(summary(clubtonepos.rcard)$tTable,dig=3) / confint(clubpos.tone.rcard,"zclubtone") /  / ##moderated by IAT?## / clubtoneiat.rcard<-lme(zrcard~zgames+position+ztone*zIAT+zclubtone*zIAT, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(clubtoneiat.rcard) / round(summary(clubtoneiat.rcard)$tTable,dig=3) / confint(clubtoneiat.rcard,"zIAT:zclubtone") /  / ##moderated by Explicit Prejudice?## / clubtoneexp.rcard<-lme(zrcard~zgames+position+ztone*zExp+zclubtone*zExp, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(clubtoneexp.rcard) / round(summary(clubtoneexp.rcard)$tTable,dig=3) / confint(clubtoneiat.rcard,"zExp:zclubtone") /  / ##catgorical analysis with African- vs. Non-African-appearing variable## / clubpos.tonecode.rcard<-lme(zrcard~zgames+position+club+tonecode, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(clubpos.tonecode.rcard) / round(summary(clubpos.tonecode.rcard)$tTable,dig=3) / confint(clubpos.tonecode.rcard,"tonecode") /  / ##moderation w/categorical analysis## /  / clubposiat.tonecode.rcard<-lme(zrcard~zgames+position+club+tonecode*scale(meanIAT), random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(clubposiat.tonecode.rcard) / round(summary(clubposiat.tonecode.rcard)$tTable,dig=3) / clubposexp.tonecode.rcard<-lme(zrcard~zgames+position+club+tonecode*scale(meanExp), random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(clubposexp.tonecode.rcard) / round(summary(clubposexp.tonecode.rcard)$tTable,dig=3) /  / ##club total of African-Appearing players analysis## / clubtonecodepos.rcard<-lme(zrcard~zgames+position+tonecode+clubblack, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(clubtonecodepos.rcard) / round(summary(clubtonecodepos.rcard)$tTable,dig=3) /  / ##moderator analyses## / clubtonecodeiat.rcard<-lme(zrcard~zgames+position+tonecode*zIAT+zclubblack*zIAT, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(clubtonecodeiat.rcard) / round(summary(clubtonecodeiat.rcard)$tTable,dig=3) / clubtonecodeexp.rcard<-lme(zrcard~zgames+position+tonecode*zExp+zclubblack*zExp, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(clubtonecodeexp.rcard) / round(summary(clubtonecodeexp.rcard)$tTable,dig=3) /  / ##SUPPLEMENTARY ANALYSES OF YELLOW CARDS AND TOTAL BOOKINGS## /  / ##do club and position predict Yellow Cards?## /  / club.effect.ycard<-lme(zycard~zgames+club, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(club.effect.ycard) / round(summary(club.effect.ycard)$tTable,dig=3) /  / position.effect.ycard<-lme(zycard~zgames+position, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(position.effect.ycard) / round(summary(position.effect.ycard)$tTable,dig=3) /  / ##zero order skin tone effect## / tone.ycard<-lme(zycard~zgames+ztone, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / round(summary(tone.ycard)$tTable,dig=3) /  / ##skin tone with confounds## / clubpos.tone.ycard<-lme(zycard~zgames+position+club+ztone, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(clubpos.tone.ycard) / round(summary(clubpos.tone.ycard)$tTable,dig=3) /  / ##moderated by IAT?## / clubposiat.tone.ycard<-lme(zycard~zgames+position+club+ztone*zIAT, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(clubposiat.tone.ycard) / round(summary(clubposiat.tone.ycard)$tTable,dig=3) /  / ##moderated by Explicit Prejudice?## / clubposexp.tone.ycard<-lme(zycard~zgames+position+club+ztone*zExp, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(clubposexp.tone.ycard) / round(summary(clubposexp.tone.ycard)$tTable,dig=3) /  / ##mean club skin tone analysis## / clubtonepos.ycard<-lme(zycard~zgames+position+ztone+zclubtone, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(clubtonepos.ycard) / round(summary(clubtonepos.ycard)$tTable,dig=3) /  / ##moderator analyses## / clubtoneiat.ycard<-lme(zycard~zgames+position+ztone*zIAT+zclubtone*zIAT, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(clubtoneiat.ycard) / round(summary(clubtoneiat.ycard)$tTable,dig=3) / clubtoneexp.ycard<-lme(zycard~zgames+position+ztone*zExp+zclubtone*zExp, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(clubtoneexp.ycard) / round(summary(clubtoneexp.ycard)$tTable,dig=3) /  / ##do club and position predict Yellow-Red Cards?## /  / club.effect.yrcard<-lme(zyrcard~zgames+club, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(club.effect.yrcard) / round(summary(club.effect.yrcard)$tTable,dig=3) /  / position.effect.yrcard<-lme(zyrcard~zgames+position, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(position.effect.yrcard) / round(summary(position.effect.yrcard)$tTable,dig=3) /  / ##zero order skin tone effect## / tone.yrcard<-lme(zyrcard~zgames+ztone, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / round(summary(tone.yrcard)$tTable,dig=3) /  / ##skin tone with confounds## / clubpos.tone.yrcard<-lme(zyrcard~zgames+position+club+ztone, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(clubpos.tone.yrcard) / round(summary(clubpos.tone.yrcard)$tTable,dig=3) /  / ##moderated by IAT?## / clubposiat.tone.yrcard<-lme(zyrcard~zgames+position+club+ztone*zIAT, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(clubposiat.tone.yrcard) / round(summary(clubposiat.tone.yrcard)$tTable,dig=3) /  / ##moderated by Explicit Prejudice?## / clubposexp.tone.yrcard<-lme(zyrcard~zgames+position+club+ztone*zExp, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(clubposexp.tone.yrcard) / round(summary(clubposexp.tone.yrcard)$tTable,dig=3) /  / ##mean club skin tone analysis## / clubtonepos.yrcard<-lme(zyrcard~zgames+position+ztone+zclubtone, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(clubtonepos.yrcard) / round(summary(clubtonepos.yrcard)$tTable,dig=3) /  / ##moderator analyses## / clubtonecodeiat.yrcard<-lme(zyrcard~zgames+position+tonecode*zIAT+zclubblack*zIAT, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(clubtonecodeiat.yrcard) / round(summary(clubtonecodeiat.yrcard)$tTable,dig=3) / clubtonecodeexp.yrcard<-lme(zyrcard~zgames+position+tonecode*zExp+zclubblack*zExp, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(clubtonecodeexp.yrcard) / round(summary(clubtonecodeexp.yrcard)$tTable,dig=3) /  / ##do club and position predict total bookings?## /  / club.effect.totbook<-lme(zbook~zgames+club, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(club.effect.totbook) / round(summary(club.effect.totbook)$tTable,dig=3) /  / position.effect.totbook<-lme(zbook~zgames+position, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(position.effect.totbook) / round(summary(position.effect.totbook)$tTable,dig=3) /  / ##zero order skin tone effect## / tone.totbook<-lme(zbook~zgames+ztone, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / round(summary(tone.totbook)$tTable,dig=3) /  / ##skin tone with confounds## / clubpos.tone.totbook<-lme(zbook~zgames+position+club+ztone, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(clubpos.tone.totbook) / round(summary(clubpos.tone.totbook)$tTable,dig=3) /  / ##moderated by IAT?## / clubposiat.tone.totbook<-lme(zbook~zgames+position+club+ztone*zIAT, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(clubposiat.tone.totbook) / round(summary(clubposiat.tone.totbook)$tTable,dig=3) /  / ##moderated by Explicit Prejudice?## / clubposexp.tone.totbook<-lme(zbook~zgames+position+club+ztone*zExp, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(clubposexp.tone.totbook) / round(summary(clubposexp.tone.totbook)$tTable,dig=3) /  / ##mean club skin tone analysis## / clubtonepos.totbook<-lme(zbook~zgames+position+ztone+zclubtone, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(clubtonepos.totbook) / round(summary(clubtonepos.totbook)$tTable,dig=3) /  / ##moderator analyses## / clubtoneiat.totbook<-lme(zbook~zgames+position+tonecode*zIAT+zclubtone*zIAT, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(clubtonecodeiat.totbook) / round(summary(clubtonecodeiat.totbook)$tTable,dig=3) / clubtoneexp.totbook<-lme(zbook~zgames+position+tonecode*zExp+zclubtone*zExp, random=~1|refCountry/refNum, data=soc, na.action=na.exclude) / anova(clubtonecodeexp.totbook) / round(summary(clubtonecodeexp.totbook)$tTable,dig=3) /  /  /  / 
